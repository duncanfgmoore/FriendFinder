
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>FriendFinder Survey</title>


    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
        crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>

    <link href="https://fonts.googleapis.com/css?family=Arvo" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <div class="container jumbotron topJumbo" >
        <h1>Take the Survey to Find a New Friend</h1>
    </div>

    <div class="container surveyContainer">
        <form style="margin-top: 20px">
            <div class="nameDiv">
                <label for="name">Your Name</label>
                <input id="name">
            </div>

            <div class="photoDiv">
                <label for="photo">Your Photo Link</label>
                <input id="photo">
            </div>

            <br>
            <br>
            <br>

            <div>
                <label for="q1">Question 1</label>
                <div>Puppies are the best?</div>
                <select class="selectpicker chosen-default" id="q1">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <br>
            <div>
                <label for="q2">Question 2</label>
                <div>Do you think you are funny?</div>
                <select class="selectpicker" id="q2">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <br>
            <div>
                <label>Question 3</label>
                <div>Do you like the movie Shrek?</div>
                <select class="selectpicker" id="q3">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <br>
            <div>
                <label>Question 4</label>
                <div>What about Shrek 2?</div>
                <select class="selectpicker" id="q4">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <br>
            <div>
                <label>Question 5</label>
                <div>Are you a fan of Frosted Flakes?</div>
                <select class="selectpicker" id="q5">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <br>
            <div>
                <label>Question 6</label>
                <div>Would you ever eat snail?</div>
                <select class="selectpicker" id="q6">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <br>
            <div>
                <label>Question 7</label>
                <div>Are you comfortable wearing shoes without socks?</div>
                <select class="selectpicker" id="q7">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <br>
            <div>
                <label>Question 8</label>
                <div>Winter is the best season?</div>
                <select class="selectpicker" id="q8">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <br>
            <div>
                <label>Question 9</label>
                <div>Are you comfortable lending people money?</div>
                <select class="selectpicker" id="q9">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Strongly Agree)</option>
                </select>
            </div>
            <br>
            <div>
                <label>Question 10</label>
                <div>Do you enjoy washing dishes?</div>
                <select class="selectpicker" id="q10">
                    <option value="1">1 (Strongly Disagree)</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5 (Stronly Agree)</option>
                </select>
            </div>
            <br>
            <button type="submit" class="btn btn-info" id="submit" data-toggle="modal" data-target="#modal">Submit</button>
    </div>
    </form>



    <div class="modal fade" id="modal" style="width: 500px; height: 500px; margin: 25 auto 0 auto">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" style="float:left">Your New Best Friend is!!!</h2>
                <button type="button" class="btn btn-default" data-dismiss="modal" style="float: right">Close</button>
            </div>
            <div id="results">
                <h3 id="match-name"></h3>

                <br>
                <img id="friendPhoto" class="img_modal" src="" width="300px" height="300px" alt="">
            </div>
        </div>
        <div class="modal-footer">
            
        </div>
    </div>


</body>

</html>

<script>
    $("#submit").on("click", function (event) {
        event.preventDefault();


        var yourInfo = {
            name: $("#name").val(),
            photo: $("#photo").val(),
            scores: [
                $("#q1").val(),
                $("#q2").val(),
                $("#q3").val(),
                $("#q4").val(),
                $("#q5").val(),
                $("#q6").val(),
                $("#q7").val(),
                $("#q8").val(),
                $("#q9").val(),
                $("#q10").val(),
            ]
        };

        console.log(yourInfo)

        $.get("/api/friends", function (friends) {

            var totalDifference = 0;

           // var scoresArray = [];

            var userInfo = yourInfo;

            var winningName = "Nobody";
            var winningScore = 300;
            var winningPhoto;

            for (var i = 0; i < friends.length; i++) {

               
                totalDifference = 0

                for (var j = 0; j < 10; j++) {

                    var questionDifference = Math.abs(parseInt(userInfo.scores[j]) - parseInt(friends[i].scores[j]));

                    totalDifference += questionDifference
                }

                
                if (totalDifference < winningScore) {
                    winningScore = totalDifference;
                    winningName = friends[i].name;
                    winningPhoto = friends[i].photo;
                }

            }
            
            console.log(winningName)
            console.log(winningScore);
            console.log(winningPhoto);



            console.log("Your new best friend is " + winningName)


            $("#match-name").text(winningName);
            $("#friendPhoto").attr("src", winningPhoto); 

        });
        $("#modal").modal("show");
    });


</script>